<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>4uFinder Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f4f4f4; display: flex; }
    /* Sidebar */
    nav { width: 220px; background: #222; color: #fff; height: 100vh; display: flex; flex-direction: column; padding: 20px; }
    nav button { margin: 5px 0; padding: 12px; background: #ff9900; border: none; border-radius: 5px; cursor: pointer; text-align: left; color: #fff; font-weight: bold; }
    nav button.active { background: #ffb84d; color: #000; }
    /* Main content */
    main { flex: 1; padding: 20px; overflow-y: auto; }
    header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    header h1 { margin: 0; }
    section { display: none; }
    section.active { display: block; }
    input, select, button { padding: 8px; margin: 5px 0; width: 100%; border-radius: 4px; border: 1px solid #ccc; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    table th, table td { padding: 10px; border: 1px solid #ccc; text-align: left; }
    .btn { padding: 5px 10px; border: none; border-radius: 3px; cursor: pointer; }
    .btn.edit { background: #4caf50; color: #fff; }
    .btn.delete { background: red; color: #fff; }
    .btn.feature { background: #ff9800; color: #fff; margin-left: 5px; }
  </style>
</head>
<body>

<nav>
  <button onclick="showSection('dashboard')" class="active">Dashboard</button>
  <button onclick="showSection('websiteSettings')">Website Settings</button>
  <button onclick="showSection('shopSettings')">Shop Settings</button>
  <button onclick="showSection('productsSection')">Products</button>
  <button onclick="showSection('ordersSection')">Orders</button>
  <button onclick="showSection('customersSection')">Customers</button>
</nav>

<main>
  <header>
    <h1>4uFinder Admin Panel</h1>
    <button onclick="logout()">Logout</button>
  </header>

  <!-- Dashboard -->
  <section id="dashboard" class="active">
    <h2>üìä Dashboard</h2>
    <p>Quick overview of your store stats.</p>
  </section>

  <!-- Website Settings -->
  <section id="websiteSettings">
    <h2>üåê Website Settings</h2>
    <input placeholder="Website Name" id="websiteName">
    <input placeholder="Logo URL" id="logoURL">
    <input placeholder="Contact Email" id="contactEmail">
    <button onclick="saveWebsiteSettings()">Save Settings</button>
  </section>

  <!-- Shop Settings -->
  <section id="shopSettings">
    <h2>üè™ Shop Settings</h2>
    <input placeholder="Currency" id="currency">
    <input placeholder="Tax Rate" id="taxRate">
    <input placeholder="Shipping Options" id="shippingOptions">
    <button onclick="saveShopSettings()">Save Settings</button>
  </section>

  <!-- Product Management -->
  <section id="productsSection">
    <h2>üõ† Products</h2>
    <input type="hidden" id="id">
    <input placeholder="Product Name" id="name">
    <input placeholder="Price" id="price">
    <input type="file" id="imageFile" accept="image/*">
    <input placeholder="Category" id="category">
    <button onclick="addProduct()">‚ûï Add / Update Product</button>

    <table>
      <thead>
        <tr>
          <th>Name</th><th>Price</th><th>Category</th><th>Actions</th>
        </tr>
      </thead>
      <tbody id="products"></tbody>
    </table>
  </section>

  <!-- Orders -->
  <section id="ordersSection">
    <h2>üßæ Orders</h2>
    <table>
      <thead>
        <tr>
          <th>Order ID</th><th>Customer</th><th>Products</th><th>Total</th><th>Status</th>
        </tr>
      </thead>
      <tbody id="ordersList"></tbody>
    </table>
  </section>

  <!-- Customers -->
  <section id="customersSection">
    <h2>üë• Customers</h2>
    <table>
      <thead>
        <tr>
          <th>Name</th><th>Email</th><th>Registered</th>
        </tr>
      </thead>
      <tbody id="customersList"></tbody>
    </table>
  </section>
</main>

<script>
const API_PRODUCTS = "https://sheetdb.io/api/v1/zq8bztk2qn6kx";
const API_ORDERS = "https://sheetdb.io/api/v1/YOUR_ORDERS_ID";
const API_CUSTOMERS = "https://sheetdb.io/api/v1/YOUR_CUSTOMERS_ID";
const CLOUD_NAME = "dxuxsa5bg";
const UPLOAD_PRESET = "cludes7u";

// Security
if(localStorage.getItem("admin") !== "true") location.href="admin-login.html";

function logout() {
  localStorage.removeItem("admin");
  location.href="admin-login.html";
}

function showSection(id){
  document.querySelectorAll('main section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelector(`nav button[onclick="showSection('${id}')"]`).classList.add('active');
}

// ---------------- PRODUCTS ----------------
let featuredProducts = [];

async function loadProducts() {
  const res = await fetch(API_PRODUCTS);
  const data = await res.json();
  let html = "";
  data.forEach(p => {
    html += `<tr>
      <td>${p.name}</td>
      <td>$${p.price}</td>
      <td>${p.category}</td>
      <td>
        <button class="btn edit" onclick="editProduct('${p.id}','${p.name}','${p.price}','${p.image}','${p.category}')">Edit</button>
        <button class="btn delete" onclick="deleteProduct('${p.id}')">Delete</button>
      </td>
    </tr>`;
  });
  document.getElementById("products").innerHTML = html;
}

async function addProduct() {
  let imageURL = document.getElementById("imageFile").dataset.old || "";
  const file = document.getElementById("imageFile").files[0];

  if(file){
    const formData = new FormData();
    formData.append("file", file);
    formData.append("upload_preset", UPLOAD_PRESET);
    const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, {method:"POST", body:formData});
    const imgData = await res.json();
    imageURL = imgData.secure_url;
  }

  if(!name.value || !price.value || !category.value){ alert("Please fill all fields"); return; }

  const product = {
    id: id.value || Date.now(),
    name: name.value,
    price: price.value,
    image: imageURL,
    category: category.value
  };

  const method = id.value ? "PUT" : "POST";
  const url = id.value ? `${API_PRODUCTS}/id/${id.value}` : API_PRODUCTS;

  await fetch(url, {
    method, headers: {"Content-Type": "application/json"}, body: JSON.stringify({ data: product })
  });

  alert("‚úÖ Product saved!");
  document.getElementById("id").value = "";
  document.getElementById("name").value = "";
  document.getElementById("price").value = "";
  document.getElementById("category").value = "";
  document.getElementById("imageFile").value = "";
  document.getElementById("imageFile").dataset.old = "";

  loadProducts();
}

function editProduct(id,name,price,image,category){
  document.getElementById("id").value = id;
  document.getElementById("name").value = name;
  document.getElementById("price").value = price;
  document.getElementById("category").value = category;
  document.getElementById("imageFile").dataset.old = image;
}

// ---------------- ORDERS ----------------
async function loadOrders(){
  const res = await fetch(API_ORDERS);
  const data = await res.json();
  let html = "";
  data.forEach(o => {
    html += `<tr>
      <td>${o.id}</td>
      <td>${o.customerName} (${o.customerEmail})</td>
      <td>${o.products}</td>
      <td>$${o.total}</td>
      <td>${o.status}</td>
    </tr>`;
  });
  document.getElementById("ordersList").innerHTML = html;
}

// ---------------- CUSTOMERS ----------------
async function loadCustomers(){
  const res = await fetch(API_CUSTOMERS);
  const data = await res.json();
  let html = "";
  data.forEach(c => {
    html += `<tr>
      <td>${c.name}</td>
      <td>${c.email}</td>
      <td>${c.registeredDate || "N/A"}</td>
    </tr>`;
  });
  document.getElementById("customersList").innerHTML = html;
}

// Initial Load
loadProducts(); loadOrders(); loadCustomers();
</script>
</body>
</html>

