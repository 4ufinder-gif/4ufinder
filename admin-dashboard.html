<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>4uFinder Admin Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; }
h1,h2,h3 { margin-bottom: 15px; }
input, button, textarea { padding: 10px; margin: 5px 0; width: 100%; box-sizing: border-box; }
.card { background: #fff; padding: 15px; margin: 10px 0; border-radius: 6px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);}
button { background: #ff9900; border: none; cursor: pointer; color: #fff; }
button:hover { background: #e68a00; }
.del { background: red; }
@media (max-width:768px){ input, button, textarea { width: 100%; } }
hr { margin: 20px 0; border: 1px solid #ddd; }
</style>
</head>
<body>

<h1>4uFinder Admin Dashboard</h1>
<p>Welcome Admin ğŸ‘‹</p>
<button onclick="logout()">Logout</button>

<hr>

<h2>ğŸ›  Manage Products</h2>
<input id="id" placeholder="Product ID">
<input id="name" placeholder="Product Name">
<input id="price" placeholder="Price">
<input type="file" id="imageFile" accept="image/*">
<input id="category" placeholder="Category">
<button onclick="addProduct()">â• Add / Update Product</button>

<div id="products"></div>

<hr>

<h2>ğŸ“‚ Manage Categories</h2>
<input id="categoryName" placeholder="Category Name">
<button onclick="addCategory()">â• Add Category</button>
<div id="categories"></div>

<hr>

<h2>ğŸ–¼ Hero / Banner Section</h2>
<input type="file" id="heroImage" accept="image/*">
<input id="heroText" placeholder="Banner Text">
<button onclick="updateHero()">Update Hero Section</button>

<hr>

<h2>â­ Featured Products</h2>
<input id="featuredProductID" placeholder="Product ID to feature">
<button onclick="addFeatured()">Add to Featured</button>
<div id="featuredProducts"></div>

<hr>

<h2>ğŸ“œ Footer & Site Info</h2>
<input id="footerText" placeholder="Footer Text">
<input id="footerLinks" placeholder="Footer Links (comma separated)">
<button onclick="updateFooter()">Update Footer</button>

<script>
// CONFIG
const API = "https://sheetdb.io/api/v1/zq8bztk2qn6kx"; // Change to your SheetDB API
const CLOUD_NAME = "dxuxsa5bg";
const UPLOAD_PRESET = "cludes7u";

// SECURITY
if (localStorage.getItem("admin") !== "true") {
  location.href = "admin-login.html";
}

function logout() {
  localStorage.removeItem("admin");
  location.href = "admin-login.html";
}

// ---------------- PRODUCTS ----------------
async function loadProducts() {
  const res = await fetch(API);
  const data = await res.json();
  let html = "";
  data.forEach(p => {
    html += `
      <div class="card">
        <b>${p.name}</b> ($${p.price})<br>
        Category: ${p.category}<br>
        <img src="${p.image}" width="100" style="margin:5px 0;"><br>
        <button class="del" onclick="deleteProduct('${p.id}')">Delete</button>
      </div>`;
  });
  document.getElementById("products").innerHTML = html;
}
loadProducts();

async function addProduct() {
  const file = document.getElementById("imageFile").files[0];
  if (!file) return alert("Select an image");
  let formData = new FormData();
  formData.append("file", file);
  formData.append("upload_preset", UPLOAD_PRESET);
  const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, { method: "POST", body: formData });
  const imgData = await res.json();
  await fetch(API, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ data:[{ id:id.value, name:name.value, price:price.value, image:imgData.secure_url, category:category.value }] })
  });
  alert("Product added/updated!");
  loadProducts();
}

async function deleteProduct(id) {
  await fetch(`${API}/id/${id}`, { method: "DELETE" });
  loadProducts();
}

// ---------------- CATEGORIES ----------------
let categoriesList = [];
function loadCategories() {
  let html = "";
  categoriesList.forEach((c,i)=>{
    html += `<div class="card">${c} <button class="del" onclick="deleteCategory(${i})">Delete</button></div>`;
  });
  document.getElementById("categories").innerHTML = html;
}
function addCategory() {
  const c = document.getElementById("categoryName").value;
  if(c) categoriesList.push(c);
  loadCategories();
}
function deleteCategory(i) {
  categoriesList.splice(i,1);
  loadCategories();
}

// ---------------- HERO ----------------
let hero = { image:"", text:"" };
async function updateHero() {
  const file = document.getElementById("heroImage").files[0];
  if(!file) return alert("Select hero image");
  let formData = new FormData();
  formData.append("file", file);
  formData.append("upload_preset", UPLOAD_PRESET);
  const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, { method: "POST", body: formData });
  const imgData = await res.json();
  hero.image = imgData.secure_url;
  hero.text = document.getElementById("heroText").value;
  alert("Hero section updated!");
}

// ---------------- FEATURED PRODUCTS ----------------
let featuredProducts = [];
function addFeatured() {
  const id = document.getElementById("featuredProductID").value;
  if(id && !featuredProducts.includes(id)) featuredProducts.push(id);
  renderFeatured();
}
function renderFeatured() {
  let html = "";
  featuredProducts.forEach(f=> html+=`<div class="card">Product ID: ${f}</div>`);
  document.getElementById("featuredProducts").innerHTML = html;
}

// ---------------- FOOTER ----------------
let footer = { text:"", links:[] };
function updateFooter() {
  footer.text = document.getElementById("footerText").value;
  footer.links = document.getElementById("footerLinks").value.split(",");
  alert("Footer updated!");
}
</script>

</body>
</html>
