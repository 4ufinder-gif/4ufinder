<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>4uFinder Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial, sans-serif; margin:0; display:flex; background:#f4f4f4; }
nav { width: 240px; background: #222; color: #fff; height: 100vh; padding: 20px; flex-shrink:0; }
nav h2 { margin-top:0; color:#ff9900; }
nav button { display:block; margin: 5px 0; padding: 12px; width:100%; background: #ff9900; border:none; border-radius:5px; color:#fff; font-weight:bold; cursor:pointer; text-align:left; }
nav button.active { background:#ffb84d; color:#000; }
main { flex:1; padding:20px; overflow-y:auto; }
header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
header h1 { margin:0; font-size:22px; }
section { display:none; }
section.active { display:block; }
input, select, button { padding:8px; margin:5px 0; border-radius:4px; border:1px solid #ccc; }
table { width:100%; border-collapse: collapse; margin-top:10px; }
table th, table td { border:1px solid #ccc; padding:8px; text-align:left; }
.btn { padding:5px 10px; border:none; border-radius:3px; cursor:pointer; }
.btn.edit { background:#4caf50; color:#fff; }
.btn.delete { background:red; color:#fff; }
.btn.feature { background:#ff9800; color:#fff; margin-left:5px; }
img.preview { max-width:100px; margin-top:5px; display:block; }
</style>
</head>
<body>

<nav>
<h2>4uFinder Admin</h2>
<button onclick="showSection('dashboard')" class="active">Dashboard</button>
<button onclick="showSection('websiteSettings')">Website Settings</button>
<button onclick="showSection('shopSettings')">Shop Settings</button>
<button onclick="showSection('productsSection')">Products</button>
<button onclick="showSection('ordersSection')">Orders</button>
<button onclick="showSection('slidersSection')">Sliders</button>
<button onclick="showSection('servicesSection')">Services</button>
<button onclick="showSection('customersSection')">Customers</button>
</nav>

<main>
<header>
<h1>Admin Panel</h1>
<button onclick="logout()">Logout</button>
</header>

<section id="dashboard" class="active">
<h2>üìä Dashboard</h2>
<p>Quick overview of your store stats.</p>
<ul>
<li id="totalProducts">Products: 0</li>
<li id="totalOrders">Orders: 0</li>
<li id="totalCustomers">Customers: 0</li>
</ul>
</section>

<section id="websiteSettings">
<h2>üåê Website Settings</h2>
<input placeholder="Website Name" id="websiteName">
<input placeholder="Logo URL" id="logoURL">
<input placeholder="Contact Email" id="contactEmail">
<button onclick="saveWebsiteSettings()">Save Settings</button>
</section>

<section id="shopSettings">
<h2>üè™ Shop Settings</h2>
<input placeholder="Currency" id="currency">
<input placeholder="Tax Rate" id="taxRate">
<input placeholder="Shipping Options" id="shippingOptions">
<button onclick="saveShopSettings()">Save Settings</button>
</section>

<section id="productsSection">
<h2>üõ† Products</h2>
<input type="hidden" id="id">
<input placeholder="Product Name" id="name">
<input placeholder="Price" id="price">
<input type="file" id="imageFile" accept="image/*" onchange="previewImage(event)">
<img id="imagePreview" class="preview" src="">
<input placeholder="Category ID" id="category">
<button onclick="addProduct()">‚ûï Add / Update Product</button>
<input type="text" placeholder="Search products..." id="productSearch" onkeyup="searchProducts()">

<table>
<thead><tr><th>Name</th><th>Price</th><th>Category</th><th>Actions</th></tr></thead>
<tbody id="products"></tbody>
</table>
</section>

<section id="ordersSection">
<h2>üßæ Orders</h2>
<table>
<thead><tr><th>ID</th><th>Customer</th><th>Products</th><th>Total</th><th>Status</th><th>Actions</th></tr></thead>
<tbody id="ordersList"></tbody>
</table>
</section>

<section id="slidersSection">
<h2>üéû Sliders</h2>
<input placeholder="Slider Title" id="sliderTitle">
<input type="file" id="sliderImage" accept="image/*" onchange="previewSliderImage(event)">
<img id="sliderPreview" class="preview" src="">
<button onclick="addSlider()">Add Slider</button>
<table>
<thead><tr><th>Title</th><th>Image</th><th>Actions</th></tr></thead>
<tbody id="sliderList"></tbody>
</table>
</section>

<section id="servicesSection">
<h2>üõé Services</h2>
<input placeholder="Service Name" id="serviceName">
<input placeholder="Service Description" id="serviceDescription">
<button onclick="addService()">Add Service</button>
<table>
<thead><tr><th>Name</th><th>Description</th><th>Actions</th></tr></thead>
<tbody id="serviceList"></tbody>
</table>
</section>

<section id="customersSection">
<h2>üë• Customers</h2>
<table>
<thead><tr><th>Name</th><th>Email</th><th>Registered</th><th>Actions</th></tr></thead>
<tbody id="customersList"></tbody>
</table>
</section>

<script>
// ---------- CONFIG ----------
const WP_SITE = "https://4ufinder.vercel.app";
const WC_KEY = "ck_034ebc6c65e49e5c4ea89b315081047cecae777c";
const WC_SECRET = "cs_c2e90ffd295a77ddf4462522a0d63577cc4afd65";

function wcAuth(){ return 'Basic ' + btoa(WC_KEY + ':' + WC_SECRET); }

// ---------- SECURITY ----------
if(localStorage.getItem("admin")!=="true") location.href="admin-login.html";
function logout(){ localStorage.removeItem("admin"); location.href="admin-login.html"; }

// ---------- UI ----------
function showSection(id){
document.querySelectorAll('main section').forEach(s=>s.classList.remove('active'));
document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
document.getElementById(id).classList.add('active');
document.querySelector(`nav button[onclick="showSection('${id}')"]`).classList.add('active');
}
function previewImage(e){ document.getElementById("imagePreview").src = URL.createObjectURL(e.target.files[0]); }
function previewSliderImage(e){ document.getElementById("sliderPreview").src = URL.createObjectURL(e.target.files[0]); }

// ---------- PRODUCTS ----------
let productsData=[];
async function loadProducts(){
    const res = await fetch(`${WP_SITE}/wp-json/wc/v3/products`, { headers: { "Authorization": wcAuth() } });
    productsData = await res.json();
    renderProducts(productsData);
    updateDashboard();
}
function renderProducts(data){
    let html="";
    data.forEach(p=>{
        html+=`<tr>
            <td>${p.name}</td>
            <td>$${p.price}</td>
            <td>${p.categories.map(c=>c.name).join(", ")}</td>
            <td>
                <button class="btn edit" onclick="editProduct(${p.id},'${p.name}','${p.price}','${p.images[0]?.src || ''}',${p.categories[0]?.id || ''})">Edit</button>
                <button class="btn delete" onclick="deleteProduct(${p.id})">Delete</button>
            </td>
        </tr>`;
    });
    document.getElementById("products").innerHTML = html;
}
async function addProduct(){
    const id = document.getElementById("id").value;
    const name = document.getElementById("name").value;
    const price = document.getElementById("price").value;
    const category = document.getElementById("category").value;
    const file = document.getElementById("imageFile").files[0];
    let imageURL = "";

    if(file){
        const formData = new FormData();
        formData.append("file", file);
        formData.append("title", name);
        const res = await fetch(`${WP_SITE}/wp-json/wp/v2/media`, { method:"POST", body:formData, headers:{"Authorization": wcAuth()} });
        const imgData = await res.json();
        imageURL = imgData.source_url;
    }

    const productData = {
        name,
        type: "simple",
        regular_price: price,
        categories: [{id: category}],
        images: imageURL ? [{src:imageURL}] : []
    };

    const method = id ? "PUT" : "POST";
    const url = id ? `${WP_SITE}/wp-json/wc/v3/products/${id}` : `${WP_SITE}/wp-json/wc/v3/products`;

    await fetch(url, { method, headers:{"Authorization": wcAuth(),"Content-Type":"application/json"}, body:JSON.stringify(productData) });
    alert("‚úÖ Product saved!");
    loadProducts();
}
function editProduct(id,name,price,image,category){
    document.getElementById("id").value=id;
    document.getElementById("name").value=name;
    document.getElementById("price").value=price;
    document.getElementById("category").value=category;
    document.getElementById("imagePreview").src=image;
}
async function deleteProduct(id){
    if(!confirm("Are you sure?")) return;
    await fetch(`${WP_SITE}/wp-json/wc/v3/products/${id}?force=true`, { method:"DELETE", headers:{ "Authorization": wcAuth() } });
    loadProducts();
}

// ---------- ORDERS ----------
async function loadOrders(){
    const res = await fetch(`${WP_SITE}/wp-json/wc/v3/orders`, { headers:{"Authorization": wcAuth()} });
    const orders = await res.json();
    let html="";
    orders.forEach(o=>{
        html+=`<tr>
            <td>${o.id}</td>
            <td>${o.billing.first_name} ${o.billing.last_name}</td>
            <td>${o.line_items.map(li=>li.name).join(", ")}</td>
            <td>$${o.total}</td>
            <td>${o.status}</td>
            <td><button class="btn delete" onclick="deleteOrder(${o.id})">Delete</button></td>
        </tr>`;
    });
    document.getElementById("ordersList").innerHTML=html;
}
async function deleteOrder(id){
    if(!confirm("Are you sure?")) return;
    await fetch(`${WP_SITE}/wp-json/wc/v3/orders/${id}?force=true`, { method:"DELETE", headers:{ "Authorization": wcAuth() } });
    loadOrders();
}

// ---------- CUSTOMERS ----------
async function loadCustomers(){
    const res = await fetch(`${WP_SITE}/wp-json/wc/v3/customers`, { headers:{ "Authorization": wcAuth() } });
    const customers = await res.json();
    let html="";
    customers.forEach(c=>{
        html+=`<tr>
            <td>${c.first_name} ${c.last_name}</td>
            <td>${c.email}</td>
            <td>${c.date_created}</td>
            <td><button class="btn delete" onclick="deleteCustomer(${c.id})">Delete</button></td>
        </tr>`;
    });
    document.getElementById("customersList").innerHTML=html;
}
async function deleteCustomer(id){
    if(!confirm("Are you sure?")) return;
    await fetch(`${WP_SITE}/wp-json/wc/v3/customers/${id}?force=true`, { method:"DELETE", headers:{ "Authorization": wcAuth() } });
    loadCustomers();
}

// ---------- DASHBOARD ----------
function updateDashboard(){
    document.getElementById("totalProducts").innerText=`Products: ${productsData.length}`;
    document.getElementById("totalOrders").innerText=`Orders: ${document.getElementById("ordersList").rows.length}`;
    document.getElementById("totalCustomers").innerText=`Customers: ${document.getElementById("customersList").rows.length}`;
}

// ---------- INITIAL LOAD ----------
loadProducts();
loadOrders();
loadCustomers();
</script>
</body>
</html>
